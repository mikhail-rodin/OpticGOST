# OpticGOST 1.2
OpticGOST - набор инструментов (а именно - макросы для САПР Zemax и плагин для MS Excel), автоматизирующих процесс оформления КД на оптические приборы.

Плагин OpticGOST для Excel генерирует таблицы оптического выпуска и др. конструкторских документов на основе данных из Zemax. Для этого все необходимые данные о конструкции и аберрациях экспортируются из Zemax в файл JSON, который октрывается в Excel через интерфейс плагина OpticGOST. 

Есть возможность строить таблицы (конструктивных параметров, параметров опт. деталей, хода лучей) по стандартным текстовым отчётам Zemax (Prescription data, Raytrace). Для автоматического экспорта всех необходимых отчётов и графиков имеется макрос ReportsExport.zpl.

## Функционал 
#### [В версии 1.3] Автозаполнение таблиц оптического выпуска по данным из файла lensdata.json

#### Создание таблицы конструктивных данных по файлу Prescription Data
![prescription_data_import](./screenshots/prescription_import.png?raw=true)
#### Заполнение таблицы хода лучей по файлам Zemax Raytrace
![raytrace_import](./screenshots/raytrace_import.png?raw=true)

4 файла Raytrace для апертурного, главного, верхнего и нижнего лучей автоматически экспортируются с нужными настройками макросом ReportsExport.zpl. 

#### Создание таблицы параметров оптических деталей системы по файлу Prescription Data.

#### Автоматический экспорт всех необходимых в КД отчётов Zemax и графиков аберраций
Графики сохраняются в папке рядом с файлом zmx в виде картинок bmp и в протабулированном текстовом виде.

## Установка
### Установка надстройки для Excel

1. В параметрах Excel разрешите выполнение надстроек без цифровой подписи:

![excel_security_settings](./screenshots/security.png?raw=true)
	
2. Перейдите в меню активации надстроек:

        Параметры -> Надстройки -> Управление -> "Надстройки Excel"

3. В окне "Надстройки" нажмите "Обзор" и перейдите в папку OpticGOST/OpticGOST_for_Excel. Выберите OpticGOSTv1.2.xlam

### Установка макроса для Zemax

Запустите "Установка макроса для Zemax.bat" 

При этом скрипт install_set_paths.ps1 создаст файл в папке OpticGOST файл analysis_export.zpl и скопирует его в папку /Documents/Zemax/Macros.
В меню Macros в Zemax должен появиться макрос ANALYSIS_EXPORT
		
	NB! Если вы переместили папку OpticGOST, макрос надо будет переустановить, так как сгенерированный скриптом файл analysis_export zpl содержит ссылки на папку OpticGOST/config.
